name: Feature Development

on:
  workflow_dispatch:
  push:
    branches-ignore: [ "main" ]
  
jobs:

  dotnet-ci:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3

    - name: dotnet CI
      uses: "./.github/templates/dotnet-ci" 
      with:
        dotnet-version: 7.0.x
        src-folder: "src"

  terraform-plan:
    name: Terraform Plan
    uses: "frasermolyneux/actions/.github/workflows/terraform-plan.yml@main"
    with: 
      environment: "DevelopmentIaCPlan"
      terraform-folder: "terraform"
      terraform-var-file: "tfvars/dev.tfvars"
      terraform-backend-file: "backends/dev.backend.hcl"
    secrets: inherit
